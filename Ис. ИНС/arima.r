library("knitr") # создание отчётов
opts_chunk$set(fig.align = 'center') # выравнивание картинок по центру

library("ggplot2") # графики
library("forecast") # прогнозирование временных рядов: ARMA и ETS модели
library("xts") # операции с временными рядами
library("dplyr")

set.seed(49)
y <- c( 0.096606, 0.078565, 0.046558, 0.018114, 0.028318, -0.034301, -0.053529, 0.023645, 0.116297, 0.363512, 0.480868, 0.689592, 0.871925, 1.034411, 1.221413, 1.21013, 1.14149, 1.034605, 0.916211, 0.878596, 0.789032, 0.469207, 0.230117, 0.068929, 0.220424, 0.491922, 0.739958, 0.957484, 1.121814, 1.157133, 1.216536, 1.221706, 1.242817, 1.181892, 1.080334, 1.023881, 0.889083, 0.756758, 0.563169, 0.426914, 0.343564, 0.183178, 0.114211, 0.054534, 0.004133, -0.192269, -0.288726, -0.32809, -0.349608, -0.465296, -0.46856, -0.366216, -0.317943, -0.307637, -0.393048, -0.460392, -0.490804, -0.35982, -0.273455, -0.253767, -0.029256, 0.105651, 0.283335, 0.448459, 0.467604, 0.590001, 0.731796, 0.690291, 0.502981, 0.390077, 0.254082, 0.263021, 0.373465, 0.450563, 0.47867, 0.456091, 0.409875, 0.181582, 0.123307, 0.079626, 0.00042, -0.071704, -0.267461, -0.269955, -0.244297, -0.276451, -0.302802, -0.314469, -0.330478, -0.336781, -0.276311, -0.291753, -0.217106, -0.147549, -0.116725, -0.10295, -0.090717, -0.039684, -0.032074, -0.017217, -0.050266, 0.12572, 0.169501, -0.043619, -0.104638, -0.062129, 0.073466, 0.194517, 0.177376, 0.205816, 0.263597, 0.338808, 0.418895, 0.56988, 0.651559, 0.618166, 0.673889, 0.581061, 0.747915, 0.675402, 0.649456, 0.559825, 0.33246, 0.269179, 0.100247, -0.07001, -0.100722, -0.107617, -0.093612, -0.09407, -0.125686, -0.164766, -0.151797, -0.161627, -0.17659, -0.171266, -0.165003, -0.158845, -0.127564, -0.101063, -0.061433, 0.021318, 0.12142, 0.186876, 0.2176, 0.174762, 0.132791, 0.044816, -0.281642, -0.361094, -0.456686, -0.621331, -0.686277, -0.726506, -0.711803, -0.633211, -0.47766, -0.381677, -0.236712, 0.020701, 0.193464, 0.434773, 0.391015, 0.090632, -0.196334, -0.339549, -0.482178, -0.662148, -0.652773, -0.496488, -0.318297, -0.228002, -0.064233, 0.058462, 0.133529, 0.369367, 0.398808, 0.407862, 0.356214, 0.233733, 0.181923, 0.146831, 0.039339, -0.151061, -0.411885, -0.62298, -0.695162, -0.826131, -0.921514, -0.990944, -1.101839, -1.254569, -1.214352, -1.149747, -1.017322, -1.238429, -1.431262, -1.485222, -1.562926, -1.826367, -1.961514, -1.910818, -1.748392, -1.326434, -0.983266, -0.623443, -0.282058, 0.016651, 0.092292, 0.259709, 0.241184, 0.171864, 0.105098, 0.046206, 0.054639, 0.139428, 0.182888, 0.416825, 0.596529, 0.8248, 0.845482, 0.808262, 0.814287, 0.832094, 0.819099, 0.676232, 0.59451, 0.448133, 0.169581, -0.002279, -0.225866, -0.438146, -0.538538, -0.583907, -0.686699, -0.768018, -0.827129, -0.848864, -0.812514, -0.872961, -0.970754, -0.982446, -0.949599, -0.957655, -0.958499, -0.900087, -0.933061, -0.955052, -0.837842, -0.579579, -0.229072, 0.076044, 0.094685, 0.085287, 0.125216, 0.386317, 0.64049, 0.862242, 0.949095, 1.062099, 1.135142, 1.259787, 1.291256, 1.46007, 1.634822, 1.937601, 2.193063, 2.329753, 2.475832, 2.641303, 2.666386, 2.736221, 2.785517, 2.785517, 2.661922, 2.450719, 2.145396, 1.92764, 1.92764, 1.647033, 1.601073, 1.542486, 1.473523, 1.311715, 1.157257, 1.067376, 0.904829, 0.832277, 0.836465, 0.747084, 0.601503, 0.512025, 0.525514, 0.531163, 0.50593, 0.534298, 0.67777, 0.817711, 0.988302, 1.150279, 1.337402, 1.645996, 1.822165, 2.04454, 2.0852, 2.097917, 2.070625, 2.005005, 1.722389, 1.530293, 1.328196, 1.275925, 1.262026, 1.246276, 1.10204, 0.892355, 0.771166, 0.590323, 0.464659, 0.314421, 0.109137, 0.017813, -0.198169, -0.299444, -0.40322, -0.506449, -0.622068, -0.818375, -1.084482, -1.164788, -1.289557, -1.41218, -1.423271, -1.489769, -1.497161, -1.514228, -1.56719, -1.62765, -1.623459, -1.605717, -1.574538, -1.560101, -1.565592, -1.550935, -1.424707, -0.822107, -0.184105, 0.416751, 0.948206, 1.323436, 1.760661, 2.041778, 2.105733, 2.194874, 2.232769, 2.221588, 2.161394, 2.09439, 2.077186, 2.105949, 2.101668, 2.084532, 2.133153, 2.074588, 1.953565, 1.820345, 1.769234, 1.673859, 1.600116, 1.458651, 1.311178, 1.162852, 0.940524, 0.689886, 0.452943, 0.331709, 0.201282, 0.136979, 0.069617, -0.001604, -0.096222, -0.12772, -0.151089, -0.166881, -0.141785, -0.07139, -0.064115, -0.077911, -0.079968, -0.030834, -0.154341, -0.097474, 0.026563, 0.073903, 0.090658, 0.094544, 0.251356, 0.452102, 0.707689, 0.930456, 1.188864, 1.33664, 1.293104, 0.943509, 0.45632, -0.012123, -0.420176, -0.57058, -0.686279, -0.767573, -0.846499, -0.957355, -1.225876, -1.350935, -1.560013, -1.677108, -1.741862, -1.812208, -1.826721, -1.853192, -1.868677, -1.821025, -1.742601, -1.686042, -1.545764, -1.369759, -1.272965, -1.123875, -1.004833, -0.925724, -0.884175, -0.817349, -0.724323, -0.600449, -0.529707, -0.533355, -0.544513, -0.527968, -0.54296, -0.58342, -0.625503, -0.676273, -0.733288, -0.785558, -0.800372, -0.832017, -0.871055, -0.902395, -0.896439, -0.880407, -0.859636, -0.884703, -0.883659, -0.840591, -0.762981, -0.775842, -0.879876, -0.825821, -0.766297, -0.698895, -0.648362, -0.565965, -0.503845, -0.478475, -0.40683, -0.313604, -0.151901, -0.033439, 0.002704, 0.058092, 0.14255, 0.229732, 0.348424, 0.43002, 0.490036, 0.658602, 0.716769, 0.795355, 0.823987, 0.885142, 0.849734, 0.728339, 0.703062, 0.566829, 0.59064, 0.709727, 0.603805, 0.55341, 0.497903, 0.627998, 0.506663, 0.508491, 0.505141, 0.432678, 0.340407, 0.237829, 0.175378, 0.161391, 0.159402, 0.15979, 0.272639, 0.152597, 0.141089, 0.094333, 0.091957, 0.182383, 0.258925, 0.369901, 0.558634, 0.732197, 0.993619, 1.021681, 1.042436, 0.860309, 0.727274, 0.617251, 0.536615, 0.501972, 0.44744, 0.359767, 0.343591, 0.398055, 0.434409, 0.475026, 0.508485, 0.585923, 0.675901, 0.741556, 0.801872, 0.867024, 0.885903, 0.833534, 0.764308, 0.709111, 0.682838, 0.693049, 0.689215, 0.742337, 0.813125, 0.805711, 0.813344, 0.862249, 0.699172, 0.470734, 0.35045, 0.203294, 0.067018, 0.015098, -0.1164, -0.127733, -0.15008, -0.120493, 0.071728, 0.188742, 0.41849, 0.63415, 0.849101, 1.216849, 1.521239, 1.521239, 1.716452, 1.62195, 1.543489, 1.374786, 1.263383, 1.244983, 1.147901, 1.103253, 1.022002, 1.050156, 1.051229, 1.088613, 1.089262, 1.202891, 1.25036, 1.254581, 1.294388, 1.345191, 1.341142, 1.292933, 1.234515, 1.204559, 1.14811, 1.108979, 1.187828, 1.243314, 1.29445, 1.220158, 1.01928, 0.861604, 0.727407, 0.592714, 0.479714, 0.3988, 0.362853, 0.336697, 0.333531, 0.387649, 0.372919, 0.32452, 0.394093, 0.505626, 0.640124, 0.841324, 1.137943, 1.471309, 1.591736, 1.660341, 1.672319, 1.67463, 1.595927, 1.440841, 1.198751, 1.126958, 1.045388, 0.989257, 0.9014, 0.868201, 0.812698, 0.805237, 0.771756, 0.776348, 0.713768, 0.718406, 0.699409, 0.720983, 0.696016, 0.651336, 0.580877, 0.472443, 0.384379, 0.333746, 0.455422, 0.604873, 0.661831, 0.683508, 0.735668, 0.855681, 0.757786, 0.673021, 0.61301, 0.628602, 0.605777, 0.396968, 0.260028, 0.239752, 0.222256, 0.212411, 0.292735, 0.515331, 0.727421, 1.037401, 1.331674, 1.525406, 1.60815, 1.559029, 1.489542, 1.460675, 1.359487, 1.264063, 1.301959, 1.354827, 1.277568, 1.169424, 1.065503, 1.037902, 0.93766, 0.812833, 0.717289, 0.694814, 0.700905, 0.695697, 0.719871, 0.713471, 0.719458, 0.642873, 0.551219, 0.416285, 0.328712, 0.308266, 0.350451, 0.445947, 0.655123, 0.857999, 1.009374, 0.878146, 0.651947, 0.500396, 0.451317, 0.354675, 0.226788, 0.069012, -0.051387, -0.121797, -0.186969, -0.283879, -0.282092, -0.205825, 0.00525, 0.286735, 0.501912, 0.699633, 0.89058, 0.817321, 0.79737, 0.691285, 0.54686, 0.321079, 0.148613, -0.069391, -0.182637, -0.310904, -0.347526, -0.353587, -0.329372, -0.289015, -0.232836, -0.182599, -0.154338, -0.098675, -0.020544, 0.014706, 0.047729, 0.03316, -0.037871, -0.032688, -0.028723, -0.001854, -0.015191, -0.089708, -0.048901, 0.018196, 0.132364, 0.19659, 0.138854, 0.06807, 0.048848, 0.208998, 0.309862, 0.507772, 0.605544, 0.592858, 0.505237, 0.57812, 0.667635, 0.679884, 0.71232, 0.688728, 0.526359, 0.389253, 0.282282, 0.190447, 0.19928, 0.151316, 0.190402, 0.244335, 0.287268, 0.346899, 0.403101, 0.546225, 0.631012, 0.661389, 0.679739, 0.735979, 0.730111, 0.812863, 0.920559, 0.984024, 1.018615, 1.052631, 0.9876, 0.924946, 0.868614, 0.812716, 0.788507, 0.781051, 0.74234, 0.690278, 0.644907, 0.580985, 0.544603, 0.549441, 0.588646, 0.828005, 1.181891, 1.457143, 1.666514, 1.74816, 1.849838, 1.912605, 1.967051, 2.013429, 2.036023, 2.040647, 2.033031, 2.0376, 2.025469, 2.026868, 2.095638, 2.193845, 2.192414, 2.245191, 2.331169, 2.399561, 2.417591, 2.440903, 2.551967, 2.591656, 2.576326, 2.677508, 2.715261, 2.654702, 2.476084, 2.331724, 2.238553, 2.169113, 2.066617, 2.055111, 2.054216, 1.993548, 1.943429, 1.896631, 1.862034, 1.84196, 1.857057, 1.876178, 1.876689, 1.926571, 1.978565, 1.961277, 1.877196, 1.759557, 1.662994, 1.622003, 1.603828, 1.63522, 1.619729, 1.554007, 1.548635, 1.504209, 1.59628, 1.69118, 1.747629, 1.843219, 1.937856, 2.03787, 2.043375, 2.057761, 2.065005, 2.06823, 2.122816, 2.224634, 2.228864, 2.194396, 2.097931, 2.053788, 1.973069, 1.84248, 1.754551, 1.705769, 1.684746, 1.674318, 1.678731, 1.663737, 1.669521, 1.667596, 1.667021, 1.565516, 1.550159, 1.518031, 1.416969, 1.292541, 1.363397, 1.477774, 1.600025, 1.649804, 1.67565, 1.902757, 1.937061, 2.013137, 2.076031, 2.115605, 2.21703, 2.43101, 2.399844, 2.431964, 2.487813, 2.44578, 2.288687, 2.075349, 1.865802, 1.778419, 1.671121, 1.468801, 1.342891, 1.300264, 1.240914, 1.157185, 1.012731, 0.886404, 0.656169, 0.523815, 0.469109, 0.420203, 0.371937, 0.338227, 0.3035, 0.222042, 0.255655, 0.253884, 0.216526, 0.160365, 0.095584, 0.05109, 0.061412, -0.02871, -0.127676, -0.250506, -0.225267, -0.221946, -0.200774, -0.079052, 0.148337, 0.433582, 0.703697, 0.996426, 1.313963, 1.454635, 1.651112, 1.794732, 1.883932, 1.910786, 2.004354, 2.044291, 2.080787, 1.983964, 1.953985, 1.89166, 1.981977, 1.961915, 1.980176, 1.870249, 1.737495, 1.836933, 1.866158, 1.888054, 1.94912, 1.86011, 1.623069, 1.479483, 1.440886, 1.611694, 1.580036, 1.463977, 1.658902, 1.731083, 1.733263, 1.749493, 1.78406, 1.803545, 1.849568, 1.805385, 1.790973, 1.77461, 1.766983, 1.746415, 1.844952, 1.994758, 2.085888, 2.21794, 2.306393, 2.534777, 2.586176, 2.538804, 2.423937, 2.290284, 2.276131, 2.301774, 2.24849, 2.159181, 1.875232, 1.738821, 1.753593, 1.985493, 2.100766, 2.202004, 2.212375, 2.160151, 2.368932, 2.543731, 2.561749, 2.684684, 2.729786, 2.698349, 2.739915, 2.736818, 2.728993, 2.694931, 2.556428, 2.450858, 2.349901, 2.288297, 2.251187, 2.195512, 2.102615, 2.198141, 2.108764, 2.012293, 2.002812, 1.917278, 1.958141, 1.927564, 1.914592, 1.88203, 2.046879, 2.224196, 2.307217, 2.396147, 2.410246, 2.454094, 2.605998, 2.612937, 2.568386, 2.639808, 2.705657, 2.722526, 2.776814, 2.810399, 2.827826, 2.782434, 2.655468, 2.515107, 2.378249, 2.421657, 2.512622, 2.516591, 2.474153, 2.379159, 2.330097, 2.321069, 2.395849, 2.412336, 2.446027, 2.431209, 2.431209, 2.185621, 2.079803, 1.950997, 1.843232, 1.850173, 1.869444, 1.841288, 1.867399, 1.928843, 1.908675, 1.859867, 1.837932, 1.830758, 1.815359, 1.863628, 1.898399, 1.949893, 1.964584, 1.876829, 1.826065, 1.854132, 2.08127, 2.296453, 2.407511, 2.448627, 2.545292, 2.61046, 2.743541, 2.928433, 3.129377, 3.144541, 3.052504, 2.943358, 2.796117, 2.625412, 2.525053, 2.496511, 2.494885, 2.458469, 2.399047, 2.357173, 2.126412, 2.013205, 1.93637, 1.785745, 1.525978, 1.420074, 1.369604, 1.407486, 1.389534, 1.374493, 1.417135, 1.427848, 1.395936, 1.449993, 1.407369, 1.500628, 1.609465, 1.632314, 1.62553, 1.551712, 1.553838, 1.553838, 1.442171, 1.457553, 1.384835, 1.33004, 1.396662, 1.523969, 1.770728, 2.008358, 2.105185, 2.255275, 2.296847, 2.104565, 2.177986, 2.241079, 2.272186, 2.302886, 2.265507, 2.174674, 2.027199, 1.796913, 1.590751, 1.380145, 1.208318, 1.080723, 1.010123, 0.943377, 1.040981, 1.205025, 1.212683, 1.33736, 1.37414, 1.409941, 1.409941, 1.554935, 1.748421, 1.938889, 2.019614, 2.086225, 2.117877, 2.120898, 2.132568, 2.154002, 2.141388, 2.191916, 2.180942, 2.215068, 2.188885, 2.161595, 2.152282, 2.157502, 2.219502, 2.399424, 2.53651, 2.592515, 2.705495, 2.689341, 2.509313, 2.263592, 2.010931, 1.554809, 1.249124, 1.043049, 0.940096, 0.82209, 0.657674, 0.591133, 0.504435, 0.44064, 0.383039, 0.241763, 0.160273, 0.096538, 0.063322, -0.089971, -0.216899, -0.251112, -0.286473, -0.35497, -0.343864, -0.361964, -0.542278, -0.707807, -0.883752, -0.972809, -1.086666, -1.188252, -1.326143, -1.398573, -1.457096, -1.451719, -1.477188, -1.435232, -1.440121, -1.473552, -1.449163, -1.482454, -1.521632, -1.516024, -1.481062, -1.382846, -1.170777, -1.084259, -0.959844, -0.703898, -0.297868, -0.101514, 0.080409, 0.188011, 0.441432, 0.508942, 0.656592, 0.909733, 1.197275, 1.422597, 1.754902, 1.922531, 2.022156, 2.109935, 2.18723, 2.205985, 2.159342, 2.193443, 2.254779, 2.301363, 2.327324, 2.412502, 2.400684, 2.382674, 2.314806, 2.342599, 2.336416, 2.289032, 2.333908, 2.331206, 2.31895, 2.395266, 2.421611, 2.435932, 2.499927, 2.528832, 2.544686, 2.54884, 2.560601, 2.564193, 2.604237, 2.636675, 2.790511, 2.857904, 2.899672, 2.919402, 3.033307, 3.034538, 2.988441, 2.994519, 3.047209, 3.103399, 3.118066, 3.124053, 3.136238, 3.17515, 3.096709, 3.045928, 3.040187, 3.007683, 3.069694, 3.124402, 3.235439, 3.196007, 3.137361, 3.057681, 3.077637, 3.053391, 3.103115, 3.125176, 3.142742, 3.069614, 3.124355, 3.112285, 3.046433, 3.036492, 3.024203, 3.018579, 2.970782, 2.934779, 2.921844, 2.882766, 2.902636, 2.924842, 2.925694, 2.872487, 2.853167, 2.827392, 2.80983, 2.782891, 2.757064, 2.637357, 2.500205, 2.576805, 2.764848, 2.87005, 3.053122, 2.988963, 2.929731, 2.877876, 2.853019, 2.792111, 2.720559, 2.735447, 2.63165, 2.593417, 2.814352, 2.802167, 2.863419, 2.926719, 2.908843, 2.856171, 2.847975, 2.849187, 2.859553, 2.867126, 2.988393, 3.023751, 2.971117, 2.989473, 2.989939, 2.927675, 2.706903, 2.594103, 2.530198, 2.513448, 2.586159, 2.808398, 2.689768, 2.602024, 2.595567, 2.863068, 2.854048, 2.909825, 2.872419, 2.996502, 3.080596, 3.017311, 3.08807, 3.166734, 3.201556, 3.209834, 3.290637, 3.364057, 3.351923, 3.280822, 3.159767, 2.994951, 2.916317, 2.867064, 2.904458, 2.947628, 3.052649, 3.121201, 3.170842, 2.987164, 3.008827, 3.006917, 2.925599, 2.818917, 2.611232, 2.430938, 2.511044, 2.618192, 2.650651, 2.492523, 2.433052, 2.416115, 2.320975, 2.323228, 2.410093, 2.363254, 2.314929, 2.303607, 2.236757, 2.123745, 2.175005, 2.195727, 2.221642, 2.182703, 2.135258, 2.119281, 2.152736, 2.116956, 2.035402, 1.950905, 1.837122, 2.003963, 2.005438, 1.858194, 2.099855, 2.178198, 2.374305, 2.513577, 2.541075, 2.506983, 2.502503, 2.490702, 2.315342, 2.176514, 2.050295, 1.89835, 1.858909, 1.950393, 1.936695, 1.975749, 1.975749, 1.919407, 1.785999, 1.679413, 1.601576, 1.543903, 1.548859, 1.573121, 1.573527, 1.58093, 1.588413, 1.547288, 1.637918, 1.635913, 1.653136, 1.70846, 1.696557, 1.705999, 1.686525, 1.681478, 1.66745, 1.736719, 1.677082, 1.472249, 1.327734, 1.141811, 1.288454, 1.499468, 1.315566, 1.253255, 1.239684, 1.583417, 1.544444, 1.644754, 1.801703, 1.973392, 2.035806 )
x <- c( 2.07394, 2.167275, 2.327994, 2.340459, 2.255226, 2.163528, 2.108155, 2.045403, 1.899052, 1.602232, 1.433441, 1.352726, 1.342739, 1.29096, 1.29426, 1.305724, 1.359381, 1.330483, 1.33781, 1.275017, 1.122473, 1.079102, 1.23021, 1.466875, 1.706008, 1.667953, 1.44086, 1.342428, 1.277163, 1.254185, 1.289397, 1.303044, 1.347155, 1.386596, 1.330486, 1.501374, 1.72327, 2.02603, 2.017413, 2.127168, 2.237003, 2.231252, 2.25192, 2.251136, 2.112183, 2.031909, 1.983281, 1.902126, 1.922234, 1.85162, 1.943638 )
a <- vector()

for(xe in x){
	print(xe)
	append(y, xe) 
	model <- auto.arima(y)
	append(a, predict(model))
}

print(a)